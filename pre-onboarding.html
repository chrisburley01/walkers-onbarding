<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Walkers Transport | Pre-Onboarding</title>

  <!-- Favicons (same as master) -->
  <link rel="icon" href="Doc/favicon.ico" sizes="any">
  <link rel="icon" type="image/png" href="Doc/favicon-32x32.png" sizes="32x32">
  <link rel="apple-touch-icon" href="Doc/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="Doc/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="Doc/android-chrome-512x512.png" sizes="512x512">

  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Brand */
    :root { --wk-blue:#002c77; --wk-dark:#0f2353; }
    body{font-family:Arial, Helvetica, sans-serif; background:#f8fafc; color:#0b1220}
    .btn-primary{background:var(--wk-blue);color:#fff}
    .btn-primary:hover{filter:brightness(.97)}
    .btn-dark{background:var(--wk-dark);color:#fff}
    .btn-dark:hover{filter:brightness(.97)}
    .shadow-soft{box-shadow:0 10px 30px rgba(0,0,0,.08)}
    .focus-ring:focus{outline:3px solid rgba(0,44,119,.25);outline-offset:2px}
    .dot{width:.625rem;height:.625rem;border-radius:9999px;background:var(--wk-blue)}
  </style>
</head>
<body>

  <!-- HEADER -->
  <header class="text-white shadow-md" style="background:#002c77">
    <div class="max-w-7xl mx-auto flex items-center gap-4 px-6 py-3">
      <img src="assets/walkers-logo.png" alt="Walkers Transport" class="h-16 w-auto select-none brightness-110 drop-shadow-md">
      <div>
        <h1 class="text-2xl font-extrabold leading-tight">Walkers Transport</h1>
        <p class="text-white/80 text-sm -mt-0.5">Can Do. Pre-Onboarding</p>
      </div>
      <nav class="hidden md:flex gap-4 text-sm ml-auto">
        <a href="#opportunity" class="hover:underline">Opportunity</a>
        <a href="#crm" class="hover:underline">CRM Entry</a>
        <a href="#creditsafe" class="hover:underline">CreditSafe</a>
        <a href="#factfind" class="hover:underline">Fact-Find</a>
        <a href="#ratesent" class="hover:underline">Rate Sent</a>
        <a href="#negotiation" class="hover:underline">Negotiation</a>
        <a href="#depot" class="hover:underline">Depot Sign-off</a>
        <a href="#cfo" class="hover:underline">CFO Sign-off</a>
      </nav>
    </div>
  </header>

  <!-- STATUS BAR -->
  <section class="bg-white border-b">
    <div class="max-w-7xl mx-auto px-6 py-3 flex items-center gap-3 text-sm">
      <span class="dot"></span><span class="font-medium">Status:</span>
      <span id="statusLabel" class="text-gray-600">Opportunity</span>
      <span class="mx-2 text-gray-300">|</span>
      <button id="saveBtn" class="px-3 py-1.5 rounded-lg btn-dark text-xs font-semibold">Save Progress</button>
      <button id="exportBtn" class="px-3 py-1.5 rounded-lg border text-xs font-semibold">Download JSON</button>
    </div>
  </section>

  <!-- MAIN -->
  <main class="max-w-7xl mx-auto px-6 py-8">
    <div class="grid lg:grid-cols-12 gap-8">

      <!-- Steps -->
      <aside class="lg:col-span-4 xl:col-span-3">
        <div class="bg-white rounded-2xl shadow-soft p-5 sticky top-6">
          <h2 class="text-lg font-bold mb-4">Pre-Onboarding Steps</h2>
          <ol class="space-y-2 text-sm" id="stepsList">
            <li data-step="opportunity" class="border rounded-xl p-3 cursor-pointer">1. Opportunity</li>
            <li data-step="crm"        class="border rounded-xl p-3 cursor-pointer">2. CRM Entry</li>
            <li data-step="creditsafe" class="border rounded-xl p-3 cursor-pointer">3. CreditSafe</li>
            <li data-step="factfind"   class="border rounded-xl p-3 cursor-pointer">4. Fact-Find</li>
            <li data-step="ratesent"   class="border rounded-xl p-3 cursor-pointer">5. Rate Sent</li>
            <li data-step="negotiation"class="border rounded-xl p-3 cursor-pointer">6. Negotiation</li>
            <li data-step="depot"      class="border rounded-xl p-3 cursor-pointer">7. Depot Manager Sign-off</li>
            <li data-step="cfo"        class="border rounded-xl p-3 cursor-pointer">8. CFO Sign-off</li>
          </ol>
          <p class="mt-6 text-xs text-gray-500">This checklist helps us keep the commercial process on track before full onboarding.</p>
        </div>
      </aside>

      <!-- Panels -->
      <section class="lg:col-span-8 xl:col-span-9 space-y-8">

        <!-- Template for each step: title, short text, Back/Next -->
        <div id="opportunity" class="bg-white rounded-2xl shadow-soft p-6">
          <h2 class="text-2xl font-extrabold mb-2">1. Opportunity</h2>
          <p class="text-gray-600">Lead identified and qualified. Confirm intent to proceed to commercial due diligence.</p>
          <div class="mt-6 flex gap-2">
            <button data-next="crm" class="px-4 py-2 rounded-xl btn-primary font-semibold">Next</button>
          </div>
        </div>

        <div id="crm" class="bg-white rounded-2xl shadow-soft p-6 hidden">
          <h2 class="text-2xl font-extrabold mb-2">2. CRM Entry</h2>
          <p class="text-gray-600">Create/verify account in CRM with basic company/contact details.</p>
          <div class="mt-6 flex gap-2">
            <button data-prev="opportunity" class="px-4 py-2 rounded-xl border font-semibold">Back</button>
            <button data-next="creditsafe" class="px-4 py-2 rounded-xl btn-primary font-semibold">Next</button>
          </div>
        </div>

        <div id="creditsafe" class="bg-white rounded-2xl shadow-soft p-6 hidden">
          <h2 class="text-2xl font-extrabold mb-2">3. CreditSafe</h2>
          <p class="text-gray-600">Perform initial credit check and risk assessment.</p>
          <div class="mt-6 flex gap-2">
            <button data-prev="crm" class="px-4 py-2 rounded-xl border font-semibold">Back</button>
            <button data-next="factfind" class="px-4 py-2 rounded-xl btn-primary font-semibold">Next</button>
          </div>
        </div>

        <div id="factfind" class="bg-white rounded-2xl shadow-soft p-6 hidden">
          <h2 class="text-2xl font-extrabold mb-2">4. Fact-Find</h2>
          <p class="text-gray-600">Capture operational requirements (services, lanes, typical volumes) for commercial proposal.</p>
          <div class="mt-6 flex gap-2">
            <button data-prev="creditsafe" class="px-4 py-2 rounded-xl border font-semibold">Back</button>
            <button data-next="ratesent" class="px-4 py-2 rounded-xl btn-primary font-semibold">Next</button>
          </div>
        </div>

        <div id="ratesent" class="bg-white rounded-2xl shadow-soft p-6 hidden">
          <h2 class="text-2xl font-extrabold mb-2">5. Rate Sent</h2>
          <p class="text-gray-600">Issue rate card/proposal to customer.</p>
          <div class="mt-6 flex gap-2">
            <button data-prev="factfind" class="px-4 py-2 rounded-xl border font-semibold">Back</button>
            <button data-next="negotiation" class="px-4 py-2 rounded-xl btn-primary font-semibold">Next</button>
          </div>
        </div>

        <div id="negotiation" class="bg-white rounded-2xl shadow-soft p-6 hidden">
          <h2 class="text-2xl font-extrabold mb-2">6. Negotiation</h2>
          <p class="text-gray-600">Agree final commercials and service scope.</p>
          <div class="mt-6 flex gap-2">
            <button data-prev="ratesent" class="px-4 py-2 rounded-xl border font-semibold">Back</button>
            <button data-next="depot" class="px-4 py-2 rounded-xl btn-primary font-semibold">Next</button>
          </div>
        </div>

        <div id="depot" class="bg-white rounded-2xl shadow-soft p-6 hidden">
          <h2 class="text-2xl font-extrabold mb-2">7. Depot Manager Sign-off</h2>
          <p class="text-gray-600">Depot reviews operational fit and confirms readiness.</p>
          <div class="mt-6 flex gap-2">
            <button data-prev="negotiation" class="px-4 py-2 rounded-xl border font-semibold">Back</button>
            <button data-next="cfo" class="px-4 py-2 rounded-xl btn-primary font-semibold">Next</button>
          </div>
        </div>

        <div id="cfo" class="bg-white rounded-2xl shadow-soft p-6 hidden">
          <h2 class="text-2xl font-extrabold mb-2">8. CFO Sign-off</h2>
          <p class="text-gray-600">Final commercial approval. Proceed to full onboarding.</p>
          <div class="mt-6 flex flex-wrap gap-3">
            <button id="previewBtn" class="px-4 py-2 rounded-xl border font-semibold">Preview JSON</button>
            <button id="downloadBtn" class="px-4 py-2 rounded-xl btn-primary font-semibold">Download JSON</button>
            <!-- Kept separate: you will manually share the main onboarding link -->
          </div>
          <pre id="jsonPreview" class="mt-6 p-4 bg-gray-50 border rounded-xl overflow-auto text-xs hidden"></pre>
        </div>

      </section>
    </div>
  </main>

  <footer class="py-10 text-center text-xs text-gray-500">
    © <span id="year"></span> Walkers Transport — Howley Park Road East, Morley, Leeds LS27 0BN · 0113 220 2800 ·
    <a class="underline" href="mailto:info@walkers-transport.co.uk">info@walkers-transport.co.uk</a>
  </footer>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    // Step IDs in order
    const order = ['opportunity','crm','creditsafe','factfind','ratesent','negotiation','depot','cfo'];
    const panels = Object.fromEntries(order.map(id => [id, document.getElementById(id)]));
    const stepsList = document.getElementById('stepsList');

    function show(id){
      order.forEach(k => panels[k].classList.toggle('hidden', k!==id));
      Array.from(stepsList.children).forEach((li,idx)=>{
        const active = order[idx]===id;
        li.classList.toggle('ring-2',active);
        li.classList.toggle('ring-blue-800',active);
        li.classList.toggle('bg-blue-50',active);
      });
      document.getElementById('statusLabel').textContent = panels[id].querySelector('h2').textContent.replace(/^[0-9]+\\.\\s*/,'');
      location.hash = id;
      localStorage.setItem('walkers_pre_onboarding_step', id);
    }

    // Nav buttons
    document.querySelectorAll('[data-next]').forEach(b=>b.addEventListener('click', ()=>show(b.dataset.next)));
    document.querySelectorAll('[data-prev]').forEach(b=>b.addEventListener('click', ()=>show(b.dataset.prev)));

    // Sidebar clicks
    stepsList.addEventListener('click', e=>{
      const li = e.target.closest('li[data-step]'); if(li) show(li.dataset.step);
    });

    // Hash / restore
    const saved = localStorage.getItem('walkers_pre_onboarding_step');
    const initial = location.hash.substring(1) || saved || 'opportunity';
    show(order.includes(initial)?initial:'opportunity');
    window.addEventListener('hashchange', ()=> show(location.hash.substring(1) || 'opportunity'));

    // Download JSON (just the step trail and timestamps; no extra fields)
    const history = [];
    function markVisit(id){ history.push({step:id, at:new Date().toISOString()}); }
    order.forEach(id=>{
      const panel = panels[id];
      const observer = new MutationObserver(()=>{ if(!panel.classList.contains('hidden')) markVisit(id); });
      observer.observe(panel,{attributes:true,attributeFilter:['class']});
    });

    document.getElementById('exportBtn').addEventListener('click', download);
    document.getElementById('downloadBtn')?.addEventListener('click', download);
    document.getElementById('previewBtn')?.addEventListener('click', ()=>{
      const pre=document.getElementById('jsonPreview');
      pre.textContent = JSON.stringify({current:location.hash.slice(1)||initial, history}, null, 2);
      pre.classList.toggle('hidden');
    });

    function download(){
      const data = { current: location.hash.slice(1)||initial, history };
      const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
      const url=URL.createObjectURL(blob);
      const a=document.createElement('a'); a.href=url; a.download='walkers-pre-onboarding.json'; a.click(); URL.revokeObjectURL(url);
    }

    // Save step only (as requested, no extra fields)
    document.getElementById('saveBtn').addEventListener('click', ()=>{
      localStorage.setItem('walkers_pre_onboarding_step', location.hash.slice(1)||initial);
      document.getElementById('statusLabel').textContent = 'Saved locally';
    });
  </script>
</body>
</html>